<p-toast position="top-right">
</p-toast>
<div class="p-grid"></div>
<div class="p-col">
    <h3 style="text-align: center;padding-top: 12px;"  class="m-0 pt-1" >{{heading}}</h3>
</div>
<div class="card">
<p-tabView>

        <div class="p-grid">
            <div class="p-col">
                <input type="text" pInputText placeholder="Ac No./Reference No." [(ngModel)]="accountNo" name="accountNo" style="width:200px">
             <button type="button" pButton pRipple label="Search" (click)="getSubmitted()"></button>
            </div>
              <div class="note" >
                <th>Note:" Reference number will be auto generated after submit . Please note it for future reference." 
               
               </th> 
               </div>
              
            <div class="p-col text-right"  >
                <button pButton type="button" icon="pi pi-plus" iconPos="right" class="mr-2 " label="Add" (click)="add()"></button>
            </div>
        </div>
   
     
        <div class="stress ease">
          
            <form #accountForm="ngForm">
                <div class="scroller">
                <p-table [value]="display" dataKey="name" editMode="row" class="tableFixed">
                    <ng-template pTemplate="header">
                        
                        
                        <tr>
                            <ng-container>
                                <!-- <th>S. No.</th> -->
                                <th *ngFor="let hr of tableNames">
                                    {{hr.name}}
                                    <!-- <span *ngIf="hr.required" style="color: yellow;">*</span> -->
                                    <br>{{hr.subText}}

                                </th>
                                 <!-- <th style="max-width: 100px;min-width: 50px;"> 
                                     Action
                                  </th>     -->
                            </ng-container>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-account let-ri="rowIndex">
                        <tr [pEditableRow]="account">
                             <ng-container *ngIf="account.edit==true || account.newRecord==true"> 
                                <td pEditableColumn *ngFor="let name of tableNames" [ngClass]="{'disabled':(name.title=='remarks' && account.staffAccountabilityStatus!='Not percieved') }" [ngStyle]="{'background-color': !name.editable  ? '#dee2e6' :'#fff' }" >
                                    <ng-container *ngIf="!name.editable  ">
                                        {{account[name.title]}}
                                    </ng-container>
                                    <ng-container>
                                        {{name.edit}}
                                    </ng-container>
                                    <p-cellEditor *ngIf="name.editable ">
                                        <ng-template pTemplate="input">
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" [min]="1" *ngIf="name.title!='complaintInBrief' && name.title!='penaltyAmount' && name.title!='staffAccountabilityStatus' && name.title!='paymentDate'&& name.title!='boLetterDate' && name.title!='branchCode' && name.title!='officeName' && name.title!='boLetterDate' && name.title!='complaintNo' && name.title!='serialNo' && name.title!='action'  && name.title!='penaltyReason'  && name.title!='penaltyReasonSubCategory' && name.title!='remarks'">
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='penaltyAmount'" minone>
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='branchCode'" >
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='complaintInBrief'" maxlength="255" >
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='complaintNo'" minLenght="15" maxlength="15" >
                                            <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='serialNo'" minLenght="15 " maxlength="15" >
                                            <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" [name]="name.title" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='staffAccountabilityStatus'">
                                                    <option value="Not percieved">Not percieved</option>
                                                    <option value="Yet to be percieved">Yet to be percieved</option>
                                                    <option value="Initiated but not completed">Initiated but not completed</option>
                                                    <option value="Closed">Closed</option>

                                            </select>
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" [name]="name.title" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='penaltyReason'">
                                                        <option value="ATM / Debit Cards">ATM / Debit Cards</option>
                                                        <option value="Mobile / electronic banking">Mobile / electronic banking</option>
                                                        <option value="Non-observance of Fair Practices Code (FPC)">Non-observance of Fair Practices Code (FPC)</option>
                                                        <option value="Credit Cards">Credit Cards</option>
                                                        <option value="Failure to meet commitments">Failure to meet commitments</option>
                                                        <option value="Levy of charges without prior notice">Levy of charges without prior notice</option>
                                                        <option value="Loans and advances">Loans and advances</option>
                                                        <option value="Non-adherence to BCSBI Codes">Non-adherence to BCSBI Codes</option>
                                                        <option value="Deposit Accounts related">Deposit Accounts related</option>
                                                        <option value="Pension payments">Pension payments</option>
                                                        <option value="Remittances">Remittances</option>
                                                        <option value="DSAs and Recovery agents">DSAs and Recovery agents</option>
                                                        <option value="Para banking">Para banking</option>
                                                        <option value="Notes and Coins">Notes and Coins</option>
                                                        <option value="Others">Others</option>
                                                    </select>
                                                    <input pInputText [required]="name.required" [name]="name.title" [type]="name.inpType" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='remarks' && account.staffAccountabilityStatus!='Not percieved'">

                                                  
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" [name]="name.title" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='penaltyReasonSubCategory' && account.penaltyReason=='ATM / Debit Cards'">
                                                        <option value="Non-payment of cash / account debited  but cash not dispensed by ATMs">Non-payment of cash / account debited  but cash not dispensed by ATMs</option>
                                                        <option value="Debit in account without use of the card or details of the card">Debit in account without use of the card or details of the card</option>
                                                        <option value="Use of stolen / cloned cards">Use of stolen / cloned cards</option>
                                                        <option value="Account debited more than once for one  withdrawal in ATMs or for POS transaction">Account debited more than once for one  withdrawal in ATMs or for POS transaction</option>
                                                        <option value="Short payment of cash / less or excess amount of cash dispensed by ATM">Short payment of cash / less or excess amount of cash dispensed by ATMs</option>
                                                        <option value="Others">Others</option>
                                                    </select>
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" [name]="name.title" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='penaltyReasonSubCategory' && account.penaltyReason=='Others'">
                                                        <option value="Banking or other services">Banking or other services</option>
                                                        <option value="Interest rates (Loans and Advances)">Interest rates (Loans and Advances)</option>
                                                        <option value="Any other direction or instruction as may be specified by the RBI on Loans and Advances and other matters">Any other direction or instruction as may be specified by the RBI on Loans and Advances and other matters</option>
                                                        <option value="Any other direction or instruction as may be specified by the RBI on Loans and Advances and other matters">Non-adherence to prescribed working hours</option>
                                                        <option value="Refusal to accept or delay in accepting payment towards taxes as required by RBI/ Government">Refusal to accept or delay in accepting payment towards taxes as required by RBI/ Government</option>
                                                        <option value="Refusal to issue or delay in issuing or Failure to Service or Delay in Servicing or Redemption of Government Securities">Refusal to issue or delay in issuing or Failure to Service or Delay in Servicing or Redemption of Government Securities</option>
                                                        <option value="Other Matters Specified by RBI">Other Matters Specified by RBI</option>
                                                    </select>
                                                    <select class="p-dropdown-label p-inputtext ng-star-inserted selectLabel" [name]="name.title" [(ngModel)]="account[name.title]" (change)="changed=true;fileUpload($event,account,name)" *ngIf="name.title=='officeName'">
                                                        <option value="Ahmedabad">Ahmedabad</option>
                                                        <option value="Bengaluru">Bengaluru</option>
                                                        <option value="Bhopal">Bhopal</option>
                                                        <option value="Bhubaneswar">Bhubaneswar</option>
                                                        <option value="Chadigarh">Chadigarh</option>
                                                        <option value="Chennai">Chennai</option>
                                                        <option value="Dehradun">Dehradun</option>
                                                        <option value="Guwahati">Guwahati</option>
                                                        <option value="Hyderabad">Hyderabad</option>
                                                        <option value="Jaipur">Jaipur</option>
                                                        <option value="Jammu">Jammu</option>
                                                        <option value="Kanpur">Kanpur</option>
                                                        <option value="Kolkata">Kolkata</option>
                                                        <option value="Mumbai(1)">Mumbai(1)</option>
                                                        <option value="Mumbai(2)">Mumbai(2)</option>
                                                        <option value="Patna">Patna</option>
                                                        <option value="New Delhi(1)">New Delhi(1)</option>
                                                        <option value="New Delhi(2)">New Delhi(2)</option>
                                                        <option value="New Delhi(3)">New Delhi(3)</option>
                                                        <option value="Raipur">Raipur</option>
                                                        <option value="Ranchi">Ranchi</option>
                                                        <option value="Thiruvananthapuram">Thiruvananthapuram</option>
                                                        
                                                        </select>
                                            
                                            <div class="p-field p-col m-0" *ngIf="name.title=='paymentDate'">
                                                <span class="p-float-label">
                                                        <p-calendar inputId="paymentDate"  [disabled]="false" dateFormat="dd-mm-yy" [(ngModel)]="account[name.title]" [name]="name.title" [minDate]="account.boLetterDate"></p-calendar>
                                                    </span>
                                            </div>
                                            <div class="p-field p-col m-0" *ngIf="name.title=='boLetterDate'">
                                                <span class="p-float-label">
                                                        <p-calendar inputId="boLetterDate"  [disabled]="false" dateFormat="dd-mm-yy" [(ngModel)]="account[name.title]" (onSelect)="boDateSelector(account)" [name]="name.title" [maxDate]="maxDateValue"></p-calendar>
                                                    </span>
                                            </div>
                                        </ng-template>

                                        <ng-template pTemplate="output">
                                            {{name.title=="paymentDate" || name.title=="boLetterDate"?(account[name.title] | date : 'dd-MM-yyyy'):account[name.title]}}
                                        </ng-template>
                                    </p-cellEditor>
                                    <ng-container>
                                        <div class="p-field p-col m-0" *ngIf="name.title=='action' && submitted==false">

                                            <i class="pi pi-trash text-danger" (click)="!submitted && delete(ri)"></i>
                                        </div>     
                                        <div class="p-field p-col m-0" *ngIf="name.title=='action' && account.edit==true">
                                            <td>
                                                <button pButton pRipple type="button" (click)="editUnClicked(account)" icon="pi pi-times-circle" class="p-button-rounded p-button-text" text-align="center"></button>
                                            </td>
                                        </div>                                        
                                        </ng-container>
                                </td>
                          
                        </ng-container>    
                        </tr>
                        <tr>
                        <ng-container *ngIf="account.edit==false && account.newRecord==null" >
                            <td pEditableColumn *ngFor="let name of tableNames"  [ngClass]="{'disabled':(!account.edit)}" [ngStyle] = "{'background-color': account.edit==false  ? '#dee2e6' :'#fff' }">
                                <ng-container>
                                    {{name.title=="paymentDate" || name.title=="boLetterDate"|| name.title=="enteredOn"?(account[name.title] | date : 'dd-MM-yyyy'):account[name.title]}}
                                </ng-container>
                                        
                                <div class="p-field p-col m-0" *ngIf="name.title=='action' && submitted==true">
                                    <td>
                                        <button pButton pRipple type="button" (click)="editClicked(account)" icon="pi pi-pencil" class="p-button-rounded p-button-text" text-align="center"></button>
                                    </td>
                                </div>

                        </ng-container>
                    </tr>
                    </ng-template>
                </p-table>
                </div>
            </form>
           
        </div>
        
    </p-tabView>
</div>
<div style="margin-top: 1%;text-align: center;">

    <button pButton icon="pi" label="Submit" (click)="submit()" [disabled]=" formInvalid || !accountForm.form.valid || (submitted==true && editMode==false)" style="border: none;background: #a20a3a;color: white;" class="p-button-primary mr-2"></button>
</div>


<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>